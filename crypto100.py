__author__ = 'seamaster'

def find_invpow(x,n):
    """Finds the integer component of the n'th root of x,
    an integer such that y ** n <= x < (y + 1) ** n.
    """
    high = 1
    while high ** n < x:
        high *= 2
    low = high/2
    while low < high:
        mid = (low + high) // 2
        if low < mid and pow(mid, n) < x:
            low = mid
        elif high > mid and pow(mid, n) > x:
            high = mid
        else:
            return mid
    return mid + 1


n = 22312518040631434472878273493520492836380113360121640442322251451334425101104603443495574360664171345537474144293669183754001740874774665912766198490105210981976955142944472441803649876670570689320594959130439023959734869244305561350328817970092685066227620334072718004266736365993868555276006749449458339571510821040942998267497698586297353155121757621172712843140132563986097763891438037972763360350877323999979272485625513839125713351992921669031696114574458478944366682669291042744804523078765297942557189752364492344309521130313850054112182166492170587585389999213256648591263193869123489987324392404614268957847
#find_invpow(n, 4)

def i2sqrt(n, r):
    x = n
    y = (x + n // x) // r
    while y < x:
        x = y
        y = (x + n // x) // r
    return x

#print(i2sqrt(n, 3))

asdfmovie = 99645666335857002522557888773043618621436753321993298671738419931038838333422097461335478910762796620959496697138640366134708083068423330618275980125950703239787227137372334347467135668166314903280206720694345072419055182428336310226468422234509252395167949077088518405713997812285961162706588908659632119327

c = 0x99dfd0065e16337a0bfc4bc62962fc302612992bd8078d74d819bb915ebfbcf0fe3ac25fa2459f3efc5d2b064f0e8254305b021ed48c014c771e7c2992dfd8eb3dcddf2acfda38e09a1f6bda61eff900079116da12e0cf3170b0fe94c9429e8081a40cc2ccc97add62428c6b58c6c9378a926569276eccaa605aa7ffcc81927305b53e9f3fcc3fde3ac8d7c8b0dd67fcc11274ecef05b27381f229938a034cb7758cc560723ace18b889f7030186a4c0ef7ecd4a13ff306b69237c570e5ec95215515a199dc8c5638e2e97118d754872725fcfd58735cbb231f50bd9653aa322d53e0ccf90e220ca9bb3ed2fc9f2899048eb78410855657f60fda730b9a261c0

c_decimal = int("%d" %c)

message = pow(c_decimal, asdfmovie-1, n)
print(message)

import binascii

hex_message = hex(message)
print(hex_message)
message_hex = binascii.unhexlify(hex_message[2:])
print(message_hex)